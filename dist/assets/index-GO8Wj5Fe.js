(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const l=new Set,I=document.getElementById("course-search"),d=document.getElementById("search-results"),S=document.getElementById("studied-list");I.addEventListener("input",e=>{const t=e.target.value.toLowerCase().trim();if(d.innerHTML="",!t){d.style.display="none";return}const n=courseData.filter(r=>(r.code.toLowerCase().includes(t)||r.title.toLowerCase().includes(t))&&!l.has(r.code)).slice(0,10);n.length>0?(d.style.display="block",n.forEach(r=>{const s=document.createElement("div");s.className="search-result-item",s.innerHTML=`<strong>${r.code}</strong> - ${r.title}`,s.onclick=()=>A(r.code),d.appendChild(s)})):d.style.display="none"});document.addEventListener("click",e=>{e.target.closest("#search-container")||(d.style.display="none"),e.target.closest("#target-search-container")||(u.style.display="none")});const B=document.getElementById("target-search"),u=document.getElementById("target-search-results"),D=document.getElementById("target-prereq-display");let g=null;B.addEventListener("input",e=>{const t=e.target.value.toLowerCase().trim();if(u.innerHTML="",!t){u.style.display="none";return}const n=courseData.filter(r=>r.code.toLowerCase().includes(t)||r.title.toLowerCase().includes(t)).slice(0,10);n.length>0?(u.style.display="block",n.forEach(r=>{const s=document.createElement("div");s.className="search-result-item",s.innerHTML=`<strong>${r.code}</strong> - ${r.title}`,s.onclick=()=>z(r.code),u.appendChild(s)})):u.style.display="none"});function z(e){g=e,B.value=e,u.style.display="none",M()}function p(e){return e?typeof e=="string"?l.has(e):e.and?e.and.every(t=>p(t)):e.or?e.or.some(t=>p(t)):!1:!0}function M(){if(!g){D.innerHTML="";return}const e=new Set;function t(s){if(!s)return"";if(typeof s=="string"){const i=l.has(s);let c=`<div class="prereq-node"><span class="${i?"status-studied":"status-unstudied"}">${i?"✓":"✗"} ${s}</span>`;if(e.has(s))c+=' <span style="color:#888; font-size:10px;">(already listed)</span>';else{e.add(s);const v=courseData.find(H=>H.code===s);v&&v.prerequisites&&v.prerequisites.parsed&&(c+=t(v.prerequisites.parsed))}return c+="</div>",c}else if(s.and){let a=`<div class="prereq-node"><span class="${p(s)?"logic-label logic-met":"logic-label"}">ALL OF:</span>`;return s.and.forEach(c=>{a+=t(c)}),a+="</div>",a}else if(s.or){let a=`<div class="prereq-node"><span class="${p(s)?"logic-label logic-met":"logic-label"}">ONE OF:</span>`;return s.or.forEach(c=>{a+=t(c)}),a+="</div>",a}return""}const n=courseData.find(s=>s.code===g);if(!n)return;let r=`<h4 style="margin-top:0; margin-bottom:10px;">Prerequisites for ${g}</h4>`;n.prerequisites&&n.prerequisites.parsed?(e.add(g),r+=t(n.prerequisites.parsed)):r+='<p style="color: #888; font-style: italic;">No prerequisites.</p>',D.innerHTML=r}function A(e){l.add(e),I.value="",d.style.display="none",N(),T(),M()}function N(){S.innerHTML=l.size===0?'<p style="color: #888; font-style: italic; text-align: center;">No courses added yet.</p>':"",l.forEach(e=>{const t=courseData.find(r=>r.code===e),n=document.createElement("div");n.className="studied-item",n.innerHTML=`
      <span title="${t?t.title:""}"><strong>${e}</strong></span>
      <span class="remove-btn" onclick="removeStudiedCourse('${e}')">✕</span>
    `,S.appendChild(n)})}N();const P=document.getElementById("sidebar"),R=document.getElementById("resizer"),O=document.getElementById("chart-container");let b=!1;R.addEventListener("mousedown",e=>{b=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none",e.preventDefault(),O.style.pointerEvents="none"});document.addEventListener("mousemove",e=>{if(!b)return;let t=e.clientX;t<250&&(t=250),t>600&&(t=600),P.style.width=t+"px"});window.addEventListener("mouseup",()=>{b&&(b=!1,document.body.style.cursor="default",document.body.style.userSelect="",O.style.pointerEvents="auto",window.dispatchEvent(new Event("resize")))});const $=[],h=[],C=new Map;function E(e,t,n){if(!C.has(e)){const r={id:e,type:t,label:n};$.push(r),C.set(e,r)}return C.get(e)}function x(e,t,n){if(e){if(typeof e=="string")E(e,"course",e),h.push({source:e,target:t});else if(e.and){const r=`AND_${n}_${Math.random().toString(36).substr(2,9)}`;E(r,"and","AND"),h.push({source:r,target:t}),e.and.forEach(s=>x(s,r,n))}else if(e.or){const r=`OR_${n}_${Math.random().toString(36).substr(2,9)}`;E(r,"or","OR"),h.push({source:r,target:t}),e.or.forEach(s=>x(s,r,n))}}}courseData.forEach(e=>{E(e.code,"course",e.code),e.prerequisites&&e.prerequisites.parsed&&x(e.prerequisites.parsed,e.code,e.code)});const m=document.getElementById("chart"),F=m.clientWidth,W=m.clientHeight,k=d3.zoom().on("zoom",e=>{q.attr("transform",e.transform)}),w=d3.select("#chart").append("svg").attr("width","100%").attr("height","100%").call(k),q=w.append("g");w.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill","#999").attr("d","M0,-5L10,0L0,5");const y=d3.forceSimulation($).force("link",d3.forceLink(h).id(e=>e.id).distance(60)).force("charge",d3.forceManyBody().strength(-300)).force("center",d3.forceCenter(F/2,W/2)).force("collide",d3.forceCollide().radius(30)),j=q.append("g").attr("class","links").selectAll("line").data(h).enter().append("line").attr("class","link").attr("marker-end","url(#arrow)"),L=q.append("g").attr("class","nodes").selectAll("g").data($).enter().append("g").attr("class","node").call(d3.drag().on("start",_).on("drag",K).on("end",U)),X={and:"#90A4AE",or:"#BCAAA4"},Y=L.append("circle").attr("r",e=>e.type==="course"?15:10);L.append("text").attr("dx",18).attr("dy",".35em").text(e=>e.label);const f=d3.select("#tooltip");L.on("mouseover",(e,t)=>{if(t.type==="course"){const n=courseData.find(r=>r.code===t.id);if(n){f.transition().duration(200).style("opacity",.9),f.html(`<strong>${n.code}</strong><br/>${n.title}<br/><br/><em>Prereqs:</em><br/>${n.prerequisites?.raw||"None"}`);const r=m.getBoundingClientRect();let s=e.clientX-r.left+10,i=e.clientY-r.top-28;f.style("left",s+"px").style("top",i+"px");const o=f.node().getBoundingClientRect();s+o.width>r.width&&(s=e.clientX-r.left-o.width-10),i<0&&(i=e.clientY-r.top+20),i+o.height>r.height&&(i=e.clientY-r.top-o.height-10),f.style("left",s+"px").style("top",i+"px")}}}).on("mouseout",()=>{f.transition().duration(500).style("opacity",0)});y.on("tick",()=>{j.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),L.attr("transform",e=>`translate(${e.x},${e.y})`)});function _(e,t){e.active||y.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}function K(e,t){t.fx=e.x,t.fy=e.y}function U(e,t){e.active||y.alphaTarget(0),t.fx=null,t.fy=null}function T(){Y.attr("fill",e=>{if(e.type==="course"){if(l.has(e.id))return"#4CAF50";const t=courseData.find(n=>n.code===e.id);return t&&(!t.prerequisites||!t.prerequisites.parsed||p(t.prerequisites.parsed))?"#FF9800":"#ccc"}return X[e.type]}).attr("stroke",e=>{if(e.type==="course"){if(l.has(e.id))return"#2E7D32";const t=courseData.find(n=>n.code===e.id);if(t&&(!t.prerequisites||!t.prerequisites.parsed||p(t.prerequisites.parsed)))return"#F57C00"}return"#fff"})}T();document.addEventListener("keydown",e=>{e.code==="Space"&&e.target.tagName!=="INPUT"&&(e.preventDefault(),w.transition().duration(750).call(k.transform,d3.zoomIdentity))});window.addEventListener("resize",()=>{const e=m.clientWidth,t=m.clientHeight;w.attr("width",e).attr("height",t),y.force("center",d3.forceCenter(e/2,t/2)),y.alpha(.3).restart()});
